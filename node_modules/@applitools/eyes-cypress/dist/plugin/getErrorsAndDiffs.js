"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const NewTestError_1 = require("@applitools/eyes/dist/errors/NewTestError");
function getErrorsAndDiffs(testResultsArr) {
    return testResultsArr.reduce(({ failed, diffs, passed }, testResults) => {
        if (testResults instanceof Error || testResults.error) {
            if (testResults.error && Object.keys(testResults).length > 1) {
                failed.push(testResults);
            }
            else {
                failed.push(testResults instanceof Error ? testResults : new Error(testResults.error.message));
            }
        }
        else {
            const testStatus = testResults.status;
            if (testStatus === 'Passed') {
                passed.push(testResults);
            }
            else {
                if (testStatus === 'Unresolved') {
                    if (testResults.isNew) {
                        testResults.error = new NewTestError_1.NewTestError(`${testResults.name}. Please approve the new baseline at ${testResults.url}`);
                        failed.push(testResults);
                    }
                    else {
                        diffs.push(testResults);
                    }
                }
                else if (testStatus === 'Failed') {
                    failed.push(testResults);
                }
            }
        }
        return { failed, diffs, passed };
    }, { failed: [], diffs: [], passed: [] });
}
exports.default = getErrorsAndDiffs;
